#!/bin/bash
#//***************************************************************************
#//
#// Program to get mean reads vs genomic separation with logarithmically 
#// spaced bins.
#//
#//***************************************************************************

# To compile:
#
# If make and a c++ compiler are available, an expecutable can be generated with 
# the command:

make


# The program reads in a bed file which contains a list of targets, and a file
# which contains a list of data file names.

# To reduce biases from binning, use the normalized pile up files generated by 
# capC-MAP.

# There is one parameters which can be set, the bin width (in log-bp units), the 
# default is set at 0.25 which seems to work well.

# The file containing the list of data files should have the following format:
/path/to/captured_normalizedpileup_probe1.bdg        nameoftarget1
/path/to/captured_normalizedpileup_probe2.bdg        nameoftarget2
# where the absolute or relative path to the file is give. The target name must match one
# of the targets in the targets bed file.

# Command line options are explained if the program is run with no arguments.
# An example command line is:
./log_reads_v_separation -t ../Data/targets.bed -f example_filelist.txt -o example_log_reads_sep.dat


# This can be plotted, e.g. using gnuplot
gnuplot --persist <<EOF

set title "average over all probes"
set logscale x
set ylabel "log(reads per kbp)"
set xlabel "genomic separation [bp]"
p "example_log_reads_sep.dat" u 4:2:3 w errorlines pt 7 title "WT G2",\
"example_log_reads_sep2.dat" u 4:2:3 w errorlines pt 7 title "M G2"

EOF
