#!/bin/bash
#//***************************************************************************
#//
#// Program to meaure the asymmetry/directionality of interactions from 
#// CaptureC data
#//
#//***************************************************************************

# To compile:
#
# If make and a c++ compiler are available, an expecutable can be generated with 
# the command:

make


# The program reads in a bed file which contains a list of targets, and a file
# which contains a list of data file names.

# To reduce biases from binning, use the normalized pile up files generated by 
# capC-MAP (actually could also use the raw pile up files and should get the same
# results).

# There are two parameters which can be set, the minimum and maximum distane from 
# the target for which reads are counted. By default these are set at 3kbp and 500kbp
# which seem to give clear results.

# The file containing the list of data files should have the following format:
/path/to/captured_normalizedpileup_probe1.bdg        nameoftarget1
/path/to/captured_normalizedpileup_probe2.bdg        nameoftarget2

# where the absolute or relative path to the file is give. The target name must match one
# of the targets in the targets bed file.

# Command line options are explained if the program is run with no arguments.
# An example command line is:

./directionality -t ../../Data/targets.bed -f example_filelist.txt -o example_directionality.dat

# The directionalisy / assymetry measure which is caluated is given by:

dir = log[ (1/W_l) \sum_{i \in l} x_i ] - log[ (1/W_r) \sum_{i \in r} x_i ]

# where the first sum runs over all restriction fragments to the left of the 
# target with distance to the target between MIN and MAX, and the second sum
# runs over all restriction fragments to the right of the target with distance
# to the target within the same range.
# x_i is the number of reads for fragment i.
# Since fragments are spaced unevely and have different sizes, the actual size 
# of the region can vary. This is accounted for by the factors W_l and W_r, which
# are the actual widths of the regions for which reads are counted. So the 
# directionality is the log ratio of the number of reads per bp to the left and to 
# the right. A positive value means interactions are more to the left, and a negative
# value means interactions are more to the right (this might be different to the 
# previous definition).
